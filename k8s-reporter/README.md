# K8s Reporter 🚀

**Web UI for analyzing Kubernetes cluster data from k8s-analyzer SQLite databases**

K8s Reporter provides an intuitive web-based dashboard for visualizing and analyzing Kubernetes cluster data exported by [k8s-analyzer](../k8s-analyzer). Built with Streamlit and Plotly, it offers interactive dashboards, detailed insights, and comprehensive reporting capabilities.

## ✨ Features

### 🏠 **Cluster Overview**
- High-level cluster health and resource distribution
- Interactive charts and metrics
- Resource type breakdown
- Namespace analysis
- Health ratio monitoring

### 🔒 **Security Analysis**
- RBAC analysis and service account insights
- Pod security context evaluation
- Privileged containers detection
- Security recommendations
- ConfigMaps and Secrets overview

### 🏷️ **Namespace Analysis**
- Per-namespace resource breakdown
- Resource distribution within namespaces
- Health status per namespace
- Top resources identification

### ❤️ **Health Dashboard**
- Real-time health monitoring
- Health trends over time
- Issue identification and tracking
- Resource health distribution

### 🔗 **Relationship Analysis**
- Resource dependency mapping
- Relationship type distribution
- Interactive relationship matrix
- Search and filter capabilities

### 🏷️ **Label Analysis & Application View**
- Comprehensive label coverage analysis and quality scoring
- Application identification using standard Kubernetes labels
- Orphaned resource detection and labeling recommendations
- Multi-label resource analysis with statistical insights
- Application health and resource breakdowns
- Interactive label filtering and search capabilities

### 📊 **Interactive Visualizations**
- Pie charts, bar charts, and line graphs
- Interactive data tables
- Real-time filtering and search
- Responsive design for all screen sizes

## 🚀 Quick Start

### Installation

```bash
# Navigate to k8s-reporter directory
cd k8s-reporter

# Install with uv (recommended)
uv sync

# Or install with pip
pip install -e .
```

### Launch the Web UI

```bash
# Launch the web interface
k8s-reporter

# Launch on custom port
k8s-reporter --port 8080

# Launch with pre-loaded database
k8s-reporter --database /path/to/cluster.db

# Launch in headless mode (for servers)
k8s-reporter --headless --host 0.0.0.0
```

The web UI will be available at `http://localhost:8501` (or your specified port).

## 📋 Prerequisites

You'll need a SQLite database generated by k8s-analyzer. If you don't have one:

```bash
# Export cluster data using k8s-analyzer
k8s-analyzer export-directory-sqlite /path/to/manifests cluster.db

# Or export multiple files
k8s-analyzer export-multiple-sqlite file1.json file2.yaml -d cluster.db
```

## 🎯 Usage Examples

### 1. **Upload Database via Web UI**
- Launch k8s-reporter
- Use the file uploader in the sidebar
- Upload your `.db` file generated by k8s-analyzer

### 2. **Pre-load Database via CLI**
```bash
k8s-reporter --database cluster.db
```

### 3. **Remote Access Setup**
```bash
# Launch for remote access
k8s-reporter --host 0.0.0.0 --port 8080 --headless
```

## 🧭 Analysis Views

### **Cluster Overview**
Get a bird's-eye view of your cluster with:
- Total resource count and health ratio
- Resource distribution pie charts
- Top namespaces ranking
- Issues summary

### **Security Analysis**
Evaluate your cluster's security posture:
- Service accounts and RBAC analysis
- Pod security context evaluation
- Privileged container detection
- Security recommendations

### **Namespace Deep-Dive**
Analyze individual namespaces:
- Resource breakdown by type
- Health distribution
- Top resources with issues
- Relationship mapping

### **Health Monitoring**
Track cluster health over time:
- Health trends and history
- Resource-level health status
- Issue identification
- Health ratio tracking

### **Relationship Mapping**
Understand resource dependencies:
- Resource relationship matrix
- Dependency visualization
- Relationship type analysis
- Search and filtering

### **Label Analysis & Governance**
Analyze and improve resource labeling:
- Label coverage metrics and quality scoring
- Common labels identification and usage patterns
- Orphaned resource detection without proper labels
- Application grouping using standard Kubernetes labels
- Multi-label resource analysis with statistical insights
- Export functionality for governance reports

### **Application View**
Application-centric cluster analysis:
- Automatic application discovery via labels
- Application health status and resource breakdowns
- Component identification and relationships
- Labeling recommendations following Kubernetes best practices
- Detailed per-application resource inventory

## 🛠️ Advanced Features

### **Filtering and Search**
- Filter by namespace, resource type, or health status
- Search resources by name or type
- Dynamic filtering across all views

### **Interactive Charts**
- Hover tooltips with detailed information
- Clickable legends and chart elements
- Responsive design for mobile and desktop

### **Data Export**
- Export filtered data to CSV
- Generate reports for compliance
- Share insights with stakeholders

## 🔧 Configuration

### **Environment Variables**
- `K8S_REPORTER_DATABASE`: Pre-load database path
- `STREAMLIT_SERVER_PORT`: Default port (8501)
- `STREAMLIT_SERVER_ADDRESS`: Default host (localhost)

### **CLI Options**
```bash
k8s-reporter --help

Options:
  --port         Port to run the app (default: 8501)
  --host         Host to bind the app (default: localhost)
  --database     Path to SQLite database file
  --headless     Run without opening browser
  --debug        Enable debug logging
```

## 📊 Screenshots

### Cluster Overview Dashboard
- Resource distribution charts
- Health metrics and trends
- Namespace breakdown

### Security Analysis View
- RBAC and service account insights
- Pod security recommendations
- Privilege escalation detection

### Namespace Analysis
- Per-namespace resource breakdown
- Health status distribution
- Resource relationship mapping

## 🏗️ Architecture

```
Web Browser
     ↓
Streamlit Frontend (Python)
     ↓
Database Client (SQLite)
     ↓
k8s-analyzer Database
```

### **Components**
- **Streamlit App**: Web UI framework
- **Database Client**: SQLite interface layer
- **Analysis Views**: Specialized dashboard components
- **Plotly Charts**: Interactive visualizations

## 🔌 Integration

### **With k8s-analyzer**
K8s Reporter is designed to work seamlessly with k8s-analyzer databases:

```bash
# Generate database with k8s-analyzer
k8s-analyzer export-directory-sqlite ./manifests cluster.db

# Analyze with k8s-reporter
k8s-reporter --database cluster.db
```

### **CI/CD Integration**
Use k8s-reporter in automated workflows:

```bash
# Generate reports in CI/CD
k8s-reporter --database cluster.db --headless --host 0.0.0.0
```

## 🚧 Roadmap

### **Coming Soon**
- **Compliance Reports**: Policy compliance checking
- **Resource Efficiency**: Optimization recommendations
- **Trends Analysis**: Historical trend analysis
- **Custom Dashboards**: User-defined views
- **Export Capabilities**: PDF and PowerPoint exports
- **Multi-cluster Support**: Compare multiple clusters

## 🤝 Contributing

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Make your changes
4. Run tests (`pytest`)
5. Commit your changes (`git commit -m 'feat: add amazing feature'`)
6. Push to the branch (`git push origin feature/amazing-feature`)
7. Open a Pull Request

## 📝 License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## 🙏 Acknowledgments

- Built with [Streamlit](https://streamlit.io/) for the web framework
- Powered by [Plotly](https://plotly.com/) for interactive visualizations
- Data processing with [Pandas](https://pandas.pydata.org/)
- Integrates with [k8s-analyzer](../k8s-analyzer) for data generation

---

**Ready to explore your Kubernetes cluster?** 🚀
Launch k8s-reporter and discover insights about your infrastructure!
